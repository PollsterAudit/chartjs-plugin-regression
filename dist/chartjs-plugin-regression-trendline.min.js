(()=>{var e={457:(e,t)=>{const r={id:"regressionTrendline",afterDatasetsUpdate(e){const t=e.options.plugins?.regressionTrendline;if(!t?.enabled)return e.regressionTrendlineCacheType=null,void(e.regressionTrendlineCache=null);const r=t.span||.3;let o=null;"getZoomedScaleBounds"in e&&(o=e.getZoomedScaleBounds()),e.data.datasets.forEach(((a,i)=>{const s=a.data;if(!s?.length)return void(e.regressionTrendlineCache&&(e.regressionTrendlineCache[i]=null));if(a.regressionTrendline&&!a.regressionTrendline.showLine)return void(e.regressionTrendlineCache&&(e.regressionTrendlineCache[i]=null));if(!Array.isArray(s)||s.length<3)return void(e.regressionTrendlineCache&&(e.regressionTrendlineCache[i]=null));const l=s.map((e=>({x:"number"==typeof e.x?e.x:Number(e[0]),y:"number"==typeof e.y?e.y:Number(e[1]),weight:t.weightField&&null!=e[t.weightField]?Number(e[t.weightField]):1}))),c=[];for(const e of l)if(!c.includes(e.x)){if(null!==o&&null!==o.x&&(e.x<o.x.min||e.x>o.x.max))continue;if(c.push(e.x),c.length>100)break}if(c.length<=1)return void(e.regressionTrendlineCache&&(e.regressionTrendlineCache[i]=null));let h=c.length<4?"linear":t.type||"local";const p=t.degree??("local"===h?2:1),g=t.steps||Math.min(50,Math.max(2,c.length/2)),d=n.computeRegression(l,h,p,r),u=e.scales.x.min,m=(e.scales.x.max-u)/g,f=[];for(let e=-1;e<=g+1;e++){const t=u+e*m,r=d.predict(t);isFinite(r)&&f.push({x:t,y:r})}e.regressionTrendlineCacheType=h,e.regressionTrendlineCache||(e.regressionTrendlineCache=[]),e.regressionTrendlineCache[i]=f}))},beforeDatasetsDraw(e){const t=e.options.plugins?.regressionTrendline;if(!t?.enabled)return;if(!e.regressionTrendlineCacheType||!e.regressionTrendlineCache)return;const{ctx:r}=e,n=e.regressionTrendlineCacheType,i=t.borderWidth||2;e.data.datasets.forEach(((s,l)=>{const c=t.color||s.borderColor||"rgba(0,0,0,0.6)",h=e.regressionTrendlineCache[l];h&&(r.lineWidth=i,r.strokeStyle=c,"linear"===n||"exponential"===n||"logarithmic"===n||"power"===n?o(r,h,(t=>e.scales.x.getPixelForValue(t.x)),(t=>e.scales.y.getPixelForValue(t.y)),e.chartArea):a(r,h,(t=>e.scales.x.getPixelForValue(t.x)),(t=>e.scales.y.getPixelForValue(t.y)),e.chartArea),r.save(),r.restore())}))}};class n{static computeRegression(e,t="linear",r=2,o=.3){const a=Math.min(...e.map((e=>e.x))),i=e.map((e=>({...e,x:e.x-a}))),s="local"===t?n.#e(i,r,o):n.#t(i,t,r);return{predict:e=>s.predict(e-a),equation:s.equation}}static#e(e,t="linear",r=2,o=.3){return{predict(t){const a=e.map((e=>Math.abs(e.x-t))).map(((e,t)=>({index:t,dist:e}))).sort(((e,t)=>e.dist-t.dist)),i=Math.floor(o*e.length),s=a[i-1]?.dist||1e-10,l=e=>{const t=1-Math.pow(e/s,3);return Math.pow(Math.max(0,t),3)},c=new Array(i),h=new Array(i),p=new Array(i);for(let n=0;n<i;n++){const{index:o}=a[n],i=e[o].x,s=e[o].y,g=e[o].weight||1,d=Math.abs(i-t);c[n]=l(d)*g,h[n]=Array.from({length:r+1},((e,t)=>Math.pow(i,t))),p[n]=s}const g=n.#r(h).map(((e,t)=>e.map(((e,t)=>e*c[t])))),d=n.#n(g,h),u=g.map((e=>e.reduce(((e,t,r)=>e+t*p[r]),0)));return n.#o(d,u).reduce(((e,r,n)=>e+r*t**n),0)},equation:`local regression (degree ${r}, span ${o})`}}static#t(e,t,r){const o=e.map((e=>e.x)),a=e.map((e=>e.y)),i=e.map((e=>e.weight||1)),s=e=>e.reduce(((e,t,r)=>e+t*i[r]),0),l=i.reduce(((e,t)=>e+t),0),c=e=>s(e)/l;if("linear"===t){const e=c(o),t=c(a),r=s(o.map((t=>(t-e)**2)));if(Math.abs(r)<1e-10)return{predict:()=>t,equation:`y = ${t.toFixed(2)} (flat line)`};const n=s(o.map(((r,n)=>(r-e)*(a[n]-t))))/r,i=t-n*e;return{predict:e=>n*e+i,equation:`y = ${n.toFixed(2)}x + ${i.toFixed(2)}`}}if("exponential"===t){const t=a.map((e=>Math.log(e))),r=n.#t(e.map(((e,r)=>({x:e.x,y:t[r],weight:i[r]}))),"linear");return{predict:e=>Math.exp(r.predict(e)),equation:`y = exp(${r.equation})`}}if("logarithmic"===t){const t=o.map((e=>Math.log(e))),r=n.#t(e.map(((e,r)=>({x:t[r],y:a[r],weight:i[r]}))),"linear");return{predict:e=>r.predict(Math.log(e)),equation:`y = ${r.equation} (log x)`}}if("power"===t){const t=o.map((e=>Math.log(e))),r=a.map((e=>Math.log(e))),s=n.#t(e.map(((e,n)=>({x:t[n],y:r[n],weight:i[n]}))),"linear");return{predict:e=>Math.exp(s.predict(Math.log(e))),equation:`y = exp(${s.equation})`}}if("polynomial"===t){const e=[],t=[];for(let n=0;n<o.length;n++){const s=Math.sqrt(i[n]);e[n]=[];for(let t=0;t<=r;t++)e[n][t]=s*Math.pow(o[n],t);t[n]=s*a[n]}const s=e[0].map(((t,r)=>e.map((e=>e[r])))),l=s.map((e=>s.map((t=>e.reduce(((e,r,n)=>e+r*t[n]),0))))),c=s.map((e=>e.reduce(((e,r,n)=>e+r*t[n]),0))),h=n.#o(l,c);return{predict:e=>h.reduce(((t,r,n)=>t+r*e**n),0),equation:`y = ${h.map(((e,t)=>`${e.toFixed(2)}x^${t}`)).join(" + ")}`}}throw new Error(`Unsupported regression type: ${t}`)}static#r(e){return e[0].map(((t,r)=>e.map((e=>e[r]))))}static#n(e,t){const r=Array(e.length).fill(0).map((()=>Array(t[0].length).fill(0)));for(let n=0;n<e.length;n++)for(let o=0;o<t[0].length;o++)for(let a=0;a<e[0].length;a++)r[n][o]+=e[n][a]*t[a][o];return r}static#o(e,t){const r=e.length;for(let n=0;n<r;n++)e[n]=[...e[n],t[n]];for(let t=0;t<r;t++){let n=t;for(let o=t+1;o<r;o++)Math.abs(e[o][t])>Math.abs(e[n][t])&&(n=o);[e[t],e[n]]=[e[n],e[t]];const o=e[t][t];for(let n=0;n<=r;n++)e[t][n]/=o;for(let n=0;n<r;n++)if(n!==t){const o=e[n][t];for(let a=0;a<=r;a++)e[n][a]-=o*e[t][a]}}return e.map((e=>e[r]))}}const o=(e,t,r,n,o)=>{if(t.length<2)return;const a=(e,t,r)=>Math.max(t,Math.min(r,e));e.beginPath();for(let i=0;i<t.length-1;i++){const s=t[i],l=a(r(s),o.left,o.right),c=a(n(s),o.top,o.bottom);0===i?e.moveTo(l,c):e.lineTo(l,c)}e.stroke()},a=(e,t,r,n,o)=>{if(t.length<4)return;const a=(e,t,r)=>Math.max(t,Math.min(r,e)),i=new Path2D,s=.5;i.moveTo(a(r(t[0]),o.left,o.right),a(n(t[0]),o.top,o.bottom));for(let e=0;e<t.length-1;e++){const l=t[e-1]||t[e],c=t[e],h=t[e+1]||c,p=t[e+2]||h,g=r(c),d=n(c),u=r(h),m=n(h),f=g+(u-r(l))/6*s,x=u-(r(p)-g)/6*s,y=d+(m-n(l))/6*s,w=m-(n(p)-d)/6*s;i.bezierCurveTo(a(f,o.left,o.right),a(y,o.top,o.bottom),a(x,o.left,o.right),a(w,o.top,o.bottom),a(u,o.left,o.right),a(m,o.top,o.bottom))}e.stroke(i)};"undefined"!=typeof window&&window.Chart&&(window.Chart.hasOwnProperty("register")?window.Chart.register(r):window.Chart.plugins.register(r));try{e.exports=r}catch(e){}}},t={};!function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}(457)})();